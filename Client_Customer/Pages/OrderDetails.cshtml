@page "{orderNumber}"
@model OrderDetailsModel
@{
    ViewData["Title"] = "Order Details";
    ViewData["Message"] = "Details about the selected order";
    bool orderAwaitingPickUp = Model.orderModel.awaitingPickUp;
    bool orderPickedUp = Model.orderModel.pickedUp;
    bool orderNotDelivered = !Model.orderModel.delivered;
    bool contractorClient = Model.clientType == "contractor";
}

<div id="details-page-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <h2 class="page-header">
                @ViewData["Message"]
            </h2>

            <div class="container">
                <h4 class="fa-bo">
                    Order number: @Model.orderModel.orderNumber
                    @if (Model.orderModel.delivered)
                    {
                        <span class="pull-right">Delivered on: @Model.orderModel.dropOffDeadline</span>
                    }
                    else if (Model.orderModel.pickedUp || Model.orderModel.awaitingPickUp)
                    {
                        <span class="pull-right">Delivering on: @Model.orderModel.dropOffDeadline</span>
                    }
                    else
                    {
                        <span class="pull-right">Delivery deadline: @Model.orderModel.dropOffDeadline</span>
                    }
                </h4>
                <div class="progress">
                    @if (Model.orderModel.delivered)
                    {
                        <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                            <span class="sr-only">
                                100% Complete (success)
                            </span>
                        </div>
                    }
                    else if (Model.orderModel.pickedUp)
                    {
                        <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 40%">
                            <span class="sr-only">
                                40% In Transit (success)
                            </span>
                        </div>
                    }
                    else
                    {
                        <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
                            <span class="sr-only">
                                0% Awaiting PickUp(success)
                            </span>
                        </div>
                    }
                </div>
                <br />
                <br />
                <label>Customer Company ID: @Model.orderModel.companyID</label>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <label>PickUp Address:</label>
            <br />
            <iframe width="400"
                    height="350"
                    frameborder="0" style="border:0"
                    src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCbrS4DNvvkVu_i4iEAWM5T_5K2H0Ck3_Y&q=
                @Model.orderModel.pickUpAddress.city,
                @Model.orderModel.pickUpAddress.zipCode,
                @Model.orderModel.pickUpAddress.country,
                @Model.orderModel.pickUpAddress.street" allowfullscreen></iframe>
            <label>Pick-Up Deadline: @Model.orderModel.pickUpDeadline</label>
        </div>

        <div class="col-md-6">
            <label>DropOff Address:</label>
            <br />
            <iframe width="400"
                    height="350"
                    frameborder="0" style="border:0"
                    src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCbrS4DNvvkVu_i4iEAWM5T_5K2H0Ck3_Y&q=
                @Model.orderModel.pickUpAddress.city,
                @Model.orderModel.pickUpAddress.zipCode,
                @Model.orderModel.pickUpAddress.country,
                @Model.orderModel.pickUpAddress.street" allowfullscreen></iframe>
            <label>DropOff Deadline: @Model.orderModel.dropOffDeadline</label>
        </div>
    </div>


    <br />
    <label>OrderNumber: @Model.orderModel.orderNumber</label>
    <br />
    <label>CompanyID: @Model.orderModel.companyID</label>
    <br />
    <label>PickUp Address: @Model.orderModel.pickUpAddress</label>
    <br />
    <label>PickUp Deadline: @Model.orderModel.pickUpDeadline</label>
    <br />
    <label>DropOff Address: @Model.orderModel.dropOffAddress</label>
    <br />
    <label>DropOff Deadline: @Model.orderModel.dropOffDeadline</label>
    <br />
    <label>Content Description: @Model.orderModel.contentDescription</label>
    <br />
    <label>ContainerSize: @Model.orderModel.containerSize</label>
    <br />
    <label>Weight: @Model.orderModel.weight</label>
    <br />
    <label>Price: @Model.orderModel.price</label>
    <br />
    <label>Size: @Model.orderModel.size</label>
    @if (contractorClient && (!orderAwaitingPickUp || !orderPickedUp) && orderNotDelivered)
    {
        <form asp-page="OrderDetails" asp-page-handler="TakeOrder" method="post">
            <button type="submit" class="pull-left btn btn-primary">Take Order</button>
        </form>
    }
    <br />
    @if (contractorClient && (orderAwaitingPickUp || orderPickedUp) && orderNotDelivered)
    {
        <form asp-page="OrderDetails" asp-page-handler="LateOrder" method="post">
            <button type="submit" class="pull-left btn btn-danger">ALERT - LATE DELIVERY</button>
        </form>
    }
</div>